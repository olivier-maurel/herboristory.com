<script>

    $(document.body).on('submit', '#searchForm', function(e){

        let search = $(this).find('#searchFormInput').val();
        
        window.history.pushState( {} , '', '?q='+search );
        
        $.get("{{ path('app_index') }}", {q: search, p: "{{ app.request.attributes.get('_route') }}" }, function(data){
            if (data.response === true) {
                window.location.replace("{{ path('app_index') }}?q="+search);
            } else { console.log(data.response);
                $('#listingPostsContainer').html(data.response);
                $('<li/>').addClass('grid-sizer position-absolute').prependTo($('#listingPostsContainer'));
                $('.header-search-icon.search-form-wrapper').removeClass('active-form');
            }
        });

        e.preventDefault();

    })

</script>